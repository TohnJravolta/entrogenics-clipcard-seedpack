{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ClipCard v1e (extended)",
  "type": "object",
  "required": [
    "id",
    "impact",
    "uncertainty",
    "hazard",
    "recheck",
    "steward",
    "authority_window",
    "kill_criteria"
  ],
  "properties": {
    "id": { "type": "string", "minLength": 1 },
    "linked_item": { "type": "string" },

    "telos": { "type": "string", "minLength": 5 },
    "cycle_phase": { "type": "string", "enum": ["Unfold","Disturb","Collapse","Bind","Dissipate","Recur"] },
    "justification": { "type": "string", "minLength": 10 },

    "impact": { "type": "integer", "minimum": 1, "maximum": 5 },
    "uncertainty": { "type": "integer", "minimum": 1, "maximum": 5 },

    "risk_factors": {
      "type": "object",
      "properties": {
        "reversibility": { "type": "integer", "minimum": 1, "maximum": 5 },
        "coupling": { "type": "integer", "minimum": 1, "maximum": 5 },
        "exposure": { "type": "string" },
        "latency_to_harm_hours": { "type": "number" },
        "equity_rights_sensitivity": { "type": "boolean" }
      }
    },

    "hazard": { "type": "string", "minLength": 10 },

    "recheck": {
      "type": "object",
      "properties": {
        "due_time": { "type": "string", "format": "date-time" },
        "jump_trigger": { "type": "string" }
      },
      "anyOf": [ { "required": ["due_time"] }, { "required": ["jump_trigger"] } ]
    },

    "steward": {
      "type": "object",
      "required": ["primary"],
      "properties": {
        "primary": { "type": "string" },
        "backup": { "type": "string" },
        "rotation_policy": { "type": "string" }
      }
    },

    "authority_window": {
      "type": "object",
      "properties": {
        "scope_limit": { "type": "string" },
        "time_limit": { "type": "string" },
        "auto_pause": { "type": "boolean" }
      },
      "minProperties": 1
    },

    "two_key_ttl": {
      "type": "object",
      "properties": {
        "required": { "type": "boolean" },
        "approvers": { "type": "array", "items": { "type": "string" } },
        "ttl_hours": { "type": "number" },
        "basis": { "type": "string" }
      }
    },

    "kill_criteria": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["condition", "action"],
        "properties": {
          "condition": { "type": "string" },
          "action": { "type": "string" }
        }
      }
    },

    "evidence_links": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name", "url"],
        "properties": {
          "name": { "type": "string" },
          "url": { "type": "string" },
          "sha256": { "type": "string" },
          "snapshot_time": { "type": "string", "format": "date-time" }
        }
      }
    }
  }
}
