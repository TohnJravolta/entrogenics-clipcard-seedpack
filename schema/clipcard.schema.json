{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ClipCard",
  "type": "object",
  "required": ["id","impact","uncertainty","hazard","recheck","steward","authority_window","kill_criteria"],
  "properties": {
    "id": {"type": "string", "minLength": 1},
    "linked_item": {"type": "string"},
    "impact": {"type": "integer","minimum":1,"maximum":5},
    "uncertainty": {"type": "integer","minimum":1,"maximum":5},
    "hazard": {"type": "string","minLength": 10},
    "recheck": {
      "type":"object",
      "properties":{
        "due_time":{"type":"string","format":"date-time"},
        "jump_trigger":{"type":"string"}
      },
      "anyOf":[ {"required":["due_time"]}, {"required":["jump_trigger"]} ]
    },
    "steward":{"type":"object","required":["primary"],"properties":{"primary":{"type":"string"},"backup":{"type":"string"}}},
    "authority_window":{
      "type":"object",
      "properties":{
        "scope_limit":{"type":"string"},
        "time_limit":{"type":"string"},
        "auto_pause":{"type":"boolean"}
      },
      "minProperties": 1
    },
    "two_key_ttl":{
      "type":"object",
      "properties":{
        "required":{"type":"boolean"},
        "approvers":{"type":"array","items":{"type":"string"}},
        "ttl_hours":{"type":"number"}
      }
    },
    "kill_criteria":{
      "type":"array",
      "minItems": 1,
      "items":{"type":"object","required":["condition","action"],"properties":{"condition":{"type":"string"},"action":{"type":"string"}}}
    },
    "evidence_links":{
      "type":"array",
      "items":{"type":"object","required":["name","url"],"properties":{"name":{"type":"string"},"url":{"type":"string"}}}
    }
  }
}
